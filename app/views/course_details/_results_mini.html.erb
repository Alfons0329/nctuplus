<script>
$(document).ready(function(){
	change_degree($("#degree"));
	$("#q_course_department_id_eq").val('<%=@q.course_department_id_eq%>');
});
</script>

<%= search_form_for @q, url:"/course_details/mini",id:"search", class:"form-horizontal", remote:true do |f| %>

	<div class="row schedule-search-bar" >
		<%=f.search_field :semester_id_eq,class:"hidden", value:params[:sem_id]||params[:q][:semester_id_eq]%>

		<div class="col-sm-5 no-padding-left">
			<%= select_tag "degree" ,options_for_select([['大學部','3'],['研究所','2'],['大學部共同','0']],params[:degree]), prompt: "分類", class: "form-control", onchange: "change_degree($(this))" %>
		</div>
		<div class="col-sm-7">
			<div class="cleaninput" onclick='clean_input($(this))'><%=fa_icon "times"%></div>
			<%= f.select :course_department_id_eq, options_from_collection_for_select(Department.where.not(:dept_type=>['no_courses','for_user']), "id", "ch_name", @q.course_department_id_eq),{:prompt=> "系所"},{ :class=> "form-control",:onchange=>"$('#search').submit();"} %>
		</div>
	</div>
	<div class="row schedule-search-bar" style="margin-top:5px;">
	  <div class="col-sm-5 no-padding-left ">
			<div class="cleaninput" onclick='clean_input($(this))'><%=fa_icon "times"%></div>
			<%=f.search_field :brief_cont, class: "form-control",placeholder:"摘要(向度)" %>
		</div>

		<div class="col-sm-5 no-padding-left">
			<div class="cleaninput" onclick='clean_input($(this))'><%=fa_icon "times"%></div>
			<%= f.search_field :time_cont, class: "form-control",placeholder:"時間" %>
		</div>
	</div>

	<div class="row schedule-search-bar"style="margin-top:5px;">
		<div class="col-sm-5 no-padding-left ">
			<div class="cleaninput" onclick='clean_input($(this))'><%=fa_icon "times"%></div>
			<%= f.search_field :course_ch_name_cont, class: "form-control",placeholder:"課名" %>
		</div>
		<div class="col-sm-5 no-padding-left">
			<div class="cleaninput" onclick='clean_input($(this))'><%=fa_icon "times"%></div>
			<%=f.search_field :teacher_name_cont, class: "form-control",placeholder:"老師" %>
		</div>
		<div class="col-sm-2 no-padding-left" style="margin-top:-20px;">
			<button class="btn btn-primary" onclick="$('#search').submit();"><%=fa_icon "search"%></button>
		</div>
	</div>

	
	
<% end %>
<div class="scrollable">
<table class="table table-hover courselist-hover " id="course_table" >

	<% cos_types=[] %>
	
	<% if !@cd_all.empty? %>

		<% @cd_all.each do |cd,dept|  %>
				<% if !cos_types.include?(cd.cos_type) %>
					<% cos_types.append(cd.cos_type) %>
					<tr class="row"><th class="<%=cos_type_class(cd.cos_type)%>"><%=cd.cos_type%></th></tr>
				<% end %>
				<tr id="cd_<%=cd.id%>" class="row" >
					<td class="">
						<p id="rating_all" class="">
							<%= link_to cd.course.ch_name, course_path(cd.course, :tid=>cd.teacher.id), :class=>"course_name", :target=>"_blank" %>
							<% cd.course.ch_name %>
							<%= dept.ch_name %>
							<%= cd.teacher.name %>
							<button class="btn btn-success btn-circle pull-right" onclick="add_class(<%=cd.id%>,'add','search')">
							<span class="glyphicon glyphicon-plus"></span>
							</button>

						</p>
						<p class="text-right">
						<% if cd.cos_type=="通識"||cd.cos_type=="外語"%>
							<%=cd.brief%> | 
						<% else %>
							<%=cd.cos_type%> | 
						<% end %>
						<strong class="course_time"><%= cd.time %></strong>
						| <%=fa_icon "graduation-cap" %> <strong><%= cd.credit %></strong>
						
						</p>
					</td>
				</tr>
		<% end %>
	<% else %>
		
			<tr class="row"><td><h4>查無結果!</h4></td></tr>

	<% end %>


</table>

</div>